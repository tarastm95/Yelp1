# üì± Twilio SMS Notification Center - –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

## ‚úÖ –©–æ –±—É–ª–æ –∑—Ä–æ–±–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞
–°—Ç–∞—Ä–∞ –ª–æ–≥—ñ–∫–∞ –≤ `signals.py` –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è–ª–∞ SMS:
- ‚ùå –í—ñ–¥–ø—Ä–∞–≤–ª—è–ª–∞ SMS –Ω–∞–≤—ñ—Ç—å –∫–æ–ª–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±—É–ª–∏ –≤–∏–º–∫–Ω–µ–Ω—ñ
- ‚ùå –ü–µ—Ä–µ–≤—ñ—Ä—è–ª–∞ `AutoResponseSettings` (—è–∫—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ –¥–ª—è Greeting/Follow-up)
- ‚ùå –°–∫–ª–∞–¥–Ω–∞ —ñ –∑–∞–ø–ª—É—Ç–∞–Ω–∞ –ª–æ–≥—ñ–∫–∞ –∑ –±–∞–≥–∞—Ç—å–º–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞–º–∏

### –†—ñ—à–µ–Ω–Ω—è
–°–ø—Ä–æ—Å—Ç–∏–ª–∏ –ª–æ–≥—ñ–∫—É –≤ `signals.py` —â–æ–± –≤–æ–Ω–∞:
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ—Å–Ω—É—é—á—É –ø—Ä–∞–≤–∏–ª—å–Ω—É –ª–æ–≥—ñ–∫—É –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤
- ‚úÖ –í—ñ–¥–ø—Ä–∞–≤–ª—è—î SMS —Ç—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ `NotificationSettings`
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è—î —Ç—ñ–ª—å–∫–∏ `business.sms_notifications_enabled`
- ‚úÖ –ü—Ä–æ—Å—Ç–∞ —ñ –∑—Ä–æ–∑—É–º—ñ–ª–∞ –ª–æ–≥—ñ–∫–∞

---

## üìä –¢—Ä–∏ —Å—Ü–µ–Ω–∞—Ä—ñ—ó SMS Notification Center

### 1Ô∏è‚É£ üìû Phone Number Found
**–ö–æ–ª–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î**: 
- `phone_in_text=True` - —Ç–µ–ª–µ—Ñ–æ–Ω –∑–Ω–∞–π–¥–µ–Ω–æ –≤ —Ç–µ–∫—Å—Ç—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `phone_in_additional_info=True` - —Ç–µ–ª–µ—Ñ–æ–Ω –∑–Ω–∞–π–¥–µ–Ω–æ –≤ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ–π —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó

**–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è**:
- SMS –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –Ω–∞ –Ω–æ–º–µ—Ä–∏ –∑ `NotificationSettings`
- –í—Å—Ç–∞–Ω–æ–≤–ª—é—î—Ç—å—Å—è `phone_sms_sent=True` (—â–æ–± –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ)

**–ü–æ–∫–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ**: –ó–Ω–∞—á–æ–∫ "Phone in Text" –∞–±–æ "Phone in Additional Info" –Ω–∞ `/events`

---

### 2Ô∏è‚É£ üí¨ Customer Reply
**–ö–æ–ª–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î**: 
- –ö–ª—ñ—î–Ω—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- –ù–µ–º–∞—î –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω—É
- –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ—Ä–∏–≤–∞—î –∞–≤—Ç–æ–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

**–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è**:
- SMS –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `webhook_views.py` ‚Üí `_send_customer_reply_sms_only()`
- `signals.py` –¥–µ–ª–µ–≥—É—î —Ü–µ–π —Å—Ü–µ–Ω–∞—Ä—ñ–π (–Ω–µ –æ–±—Ä–æ–±–ª—è—î —Å–∞–º)

**–ü–æ–∫–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ**: –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π —Å—Ü–µ–Ω–∞—Ä—ñ–π (–±–µ–∑ –æ–∫—Ä–µ–º–æ–≥–æ –∑–Ω–∞—á–∫–∞)

---

### 3Ô∏è‚É£ ‚úÖ Phone Opt-in
**–ö–æ–ª–∏ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î**: 
- `phone_opt_in=True` - –∫–ª—ñ—î–Ω—Ç –¥–∞–≤ –∑–≥–æ–¥—É –Ω–∞–¥–∞—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É
- Yelp –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–¥—ñ—é `CONSUMER_PHONE_NUMBER_OPT_IN_EVENT`

**–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è**:
- SMS –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –Ω–∞ –Ω–æ–º–µ—Ä–∏ –∑ `NotificationSettings`

**–ü–æ–∫–∞–∑—É—î—Ç—å—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ**: –ó–Ω–∞—á–æ–∫ "Phone Opt-In" –Ω–∞ `/events`

---

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –§–∞–π–ª: `backend/webhooks/signals.py`

**–©–æ –±—É–ª–æ –≤–∏–¥–∞–ª–µ–Ω–æ**:
- ‚ùå –õ–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `AutoResponseSettings.sms_on_phone_found`
- ‚ùå –õ–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `AutoResponseSettings.sms_on_customer_reply`
- ‚ùå –õ–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `AutoResponseSettings.sms_on_phone_opt_in`
- ‚ùå –õ–æ–≥—ñ–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `AutoResponseSettings.enabled`
- ‚ùå –°–∫–ª–∞–¥–Ω–∞ –ª–æ–≥—ñ–∫–∞ mapping —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ –Ω–∞ `phone_available`

**–©–æ –∑–∞–ª–∏—à–∏–ª–æ—Å—è**:
- ‚úÖ –ü—Ä–æ—Å—Ç–∞ –ª–æ–≥—ñ–∫–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è 3 —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ `business.sms_notifications_enabled`
- ‚úÖ –í—ñ–¥–ø—Ä–∞–≤–∫–∞ SMS —á–µ—Ä–µ–∑ `NotificationSettings`
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ `phone_sms_sent` –¥–ª—è Phone Number Found

**–©–æ –ù–ï –ß–Ü–ü–ê–õ–ò**:
- ‚úÖ `AutoResponseSettings` –¥–ª—è Greeting Message
- ‚úÖ `AutoResponseSettings` –¥–ª—è Follow-up –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- ‚úÖ `AutoResponseSettings` –¥–ª—è Auto-Response
- ‚úÖ –í—Å—é –ª–æ–≥—ñ–∫—É –≤ `webhook_views.py`

---

## üéØ –õ–æ–≥—ñ–∫–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤

```python
# –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç (–∑–≤–µ—Ä—Ö—É –≤–Ω–∏–∑):
if getattr(instance, 'phone_opt_in', False):
    scenario = "‚úÖ Phone Opt-in"  # –ü–†–Ü–û–†–ò–¢–ï–¢ #1
elif getattr(instance, 'phone_in_text', False) or getattr(instance, 'phone_in_additional_info', False):
    scenario = "üìû Phone Number Found"  # –ü–†–Ü–û–†–ò–¢–ï–¢ #2
elif not instance.phone_number:
    scenario = "üí¨ Customer Reply"  # –ü–†–Ü–û–†–ò–¢–ï–¢ #3
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–¢–µ–ø–µ—Ä SMS –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –ü–†–ê–í–ò–õ–¨–ù–û**:
- ‚úÖ –¢—ñ–ª—å–∫–∏ –∫–æ–ª–∏ `business.sms_notifications_enabled = True`
- ‚úÖ –¢—ñ–ª—å–∫–∏ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤
- ‚úÖ –ß–µ—Ä–µ–∑ `NotificationSettings` (–Ω–æ–º–µ—Ä–∏ –±—ñ–∑–Ω–µ—Å—É)
- ‚úÖ –ë–µ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è
- ‚úÖ –ü—Ä–æ—Å—Ç–∏–π —ñ –∑—Ä–æ–∑—É–º—ñ–ª–∏–π –∫–æ–¥

**Greeting Message —ñ Follow-up –ù–ï –ó–ê–ß–ï–ü–õ–ï–ù–Ü**:
- ‚úÖ –í—Å—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è `AutoResponseSettings` –ø—Ä–∞—Ü—é—é—Ç—å —è–∫ —Ä–∞–Ω—ñ—à–µ
- ‚úÖ AI –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—î —è–∫ —Ä–∞–Ω—ñ—à–µ
- ‚úÖ –í—Å—ñ —à–∞–±–ª–æ–Ω–∏ –ø—Ä–∞—Ü—é—é—Ç—å —è–∫ —Ä–∞–Ω—ñ—à–µ

---

## üìÖ –î–∞—Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è
21 –∂–æ–≤—Ç–Ω—è 2025

